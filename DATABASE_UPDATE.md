# üóÑÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ: SQLite –ë–∞–∑–∞ –î–∞–Ω–Ω—ã—Ö

## ‚ú® –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### –ù–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **SQLite –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö** –≤–º–µ—Å—Ç–æ AsyncStorage!

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

| –î–æ (AsyncStorage) | –¢–µ–ø–µ—Ä—å (SQLite) |
|-------------------|-----------------|
| ‚ö†Ô∏è –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ | ‚úÖ –ë—ã—Å—Ç—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã |
| ‚ùå –¢–æ–ª—å–∫–æ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ | ‚úÖ SQL –∑–∞–ø—Ä–æ—Å—ã, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ |
| ‚ùå –ù–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π | ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏ |
| ‚ùå –ù–µ—Ç –∏–Ω–¥–µ–∫—Å–æ–≤ | ‚úÖ –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è |
| ‚ùå –°–ª–æ–∂–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å–æ —Å–≤—è–∑—è–º–∏ | ‚úÖ –†–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å |

---

## üì¶ –ß—Ç–æ –±—ã–ª–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ

```bash
npm install expo-sqlite
```

–ü–∞–∫–µ—Ç: `expo-sqlite` (–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ—Ç Expo)

---

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### 3 —Ç–∞–±–ª–∏—Ü—ã:

1. **`pef_records`** - –ó–∞–ø–∏—Å–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π PEF
   - –•—Ä–∞–Ω–∏—Ç –¥–∞—Ç—É, –≤—Ä–µ–º—è —Å—É—Ç–æ–∫, –∑–Ω–∞—á–µ–Ω–∏–µ PEF
   - –•—Ä–∞–Ω–∏—Ç —Å–∏–º–ø—Ç–æ–º—ã (–∫–∞—à–µ–ª—å, –æ–¥—ã—à–∫–∞, –º–æ–∫—Ä–æ—Ç–∞)
   - –ê–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç ID

2. **`profile`** - –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –ü–æ–ª, –≥–æ–¥ —Ä–æ–∂–¥–µ–Ω–∏—è, —Ä–æ—Å—Ç
   - –ú–µ—Ç–æ–¥ —Ä–∞—Å—á—ë—Ç–∞ –Ω–æ—Ä–º—ã (–∞–≤—Ç–æ/—Ä—É—á–Ω–æ–π)
   - –í—Å–µ–≥–¥–∞ 1 –∑–∞–ø–∏—Å—å (id=1)

3. **`app_settings`** - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   - –ö–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ
   - –•—Ä–∞–Ω–∏—Ç —Å—Ç–∞—Ç—É—Å –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞ –∏ –¥—Ä.

---

## üìÅ –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã

### –ö–æ–¥
- `src/services/DatabaseStorage.ts` - –û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å (700+ —Å—Ç—Ä–æ–∫)

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `DATABASE_STORAGE.md` - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
- `test-database.md` - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

### –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- `src/screens/AddEntryScreen.tsx` - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—É—é –ë–î
- `src/screens/onboarding/ProfileSetupScreen.tsx` - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—É—é –ë–î
- `src/screens/SettingsScreen.tsx` - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—É—é –ë–î
- `src/AppNavigator.tsx` - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—É—é –ë–î
- `FILES_INDEX.md` - –û–±–Ω–æ–≤–ª—ë–Ω –∏–Ω–¥–µ–∫—Å

---

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞—ë—Ç—Å—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ. –ù–∏—á–µ–≥–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –¥–µ–ª–∞—Ç—å –Ω–µ –Ω—É–∂–Ω–æ!

### –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å:

```bash
npx expo start
```

–ó–∞—Ç–µ–º –Ω–∞–∂–º–∏—Ç–µ `w` –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞ –∏–ª–∏ `r` –¥–ª—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏.

---

## üîß API –ú–µ—Ç–æ–¥–æ–≤ (–∫—Ä–∞—Ç–∫–∏–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫)

### –ó–∞–ø–∏—Å–∏ PEF
```typescript
import { storage } from './services/DatabaseStorage';

// –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å
const id = await storage.saveRecord({
  date: '2024-11-19',
  timePeriod: 'morning',
  value: 450,
  cough: false,
  breathlessness: false,
  sputum: false,
});

// –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏
const records = await storage.getAllRecords();

// –ü–æ–ª—É—á–∏—Ç—å –∑–∞ –ø–µ—Ä–∏–æ–¥
const filtered = await storage.getRecords('2024-11-01', '2024-11-19');

// –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å
await storage.updateRecord(id, { ...record });

// –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å
await storage.deleteRecord(id);
```

### –ü—Ä–æ—Ñ–∏–ª—å
```typescript
// –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
await storage.saveProfile({
  gender: 'M',
  birthYear: 1990,
  heightCm: 180,
  normMethod: 'auto',
});

// –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
const profile = await storage.getProfile();
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
```typescript
// –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π
const count = await storage.getRecordsCount();

// –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–º–∏–Ω, –º–∞–∫—Å, —Å—Ä–µ–¥–Ω)
const stats = await storage.getStatistics();
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```typescript
// –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
await storage.clearAll();

// –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
const backup = await storage.exportData();

// –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
await storage.importData(backup);
```

---

## üìö –ì–¥–µ —á–∏—Ç–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ

| –î–æ–∫—É–º–µ–Ω—Ç | –ß—Ç–æ —Ç–∞–º |
|----------|---------|
| **DATABASE_STORAGE.md** | üìñ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API |
| **test-database.md** | üß™ –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è |
| **FILES_INDEX.md** | üìë –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å —Ñ–∞–π–ª–æ–≤ |

---

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ–π—á–∞—Å

- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π PEF –≤ SQLite
- [x] –ß—Ç–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- [x] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π
- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
- [x] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–º–∏–Ω, –º–∞–∫—Å, —Å—Ä–µ–¥–Ω)
- [x] –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
- [x] –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
- [x] –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏
- [x] –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –±—ã–ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ AsyncStorage, –æ–Ω–∏ **–ù–ï –º–∏–≥—Ä–∏—Ä—É—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**.

### –û–ø—Ü–∏–∏:

**–í–∞—Ä–∏–∞–Ω—Ç 1:** –ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
- –ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –ü—Ä–æ–π–¥–∏—Ç–µ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ —Å–Ω–æ–≤–∞
- –ë–∞–∑–∞ —Å–æ–∑–¥–∞—Å—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–í–∞—Ä–∏–∞–Ω—Ç 2:** –ú–∏–≥—Ä–∞—Ü–∏—è –≤—Ä—É—á–Ω—É—é (–¥–ª—è production)
- –°–æ–∑–¥–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏
- –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ AsyncStorage
- –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤ SQLite —á–µ—Ä–µ–∑ `storage.importData()`

---

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### "Database not open"
**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –ë–∞–∑–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –º–æ–¥—É–ª—è.

### "No such table"
**–†–µ—à–µ–Ω–∏–µ:**
```typescript
await storage.dropAllTables(); // –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—ã
```

### –°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –≤–∏–¥–Ω—ã
**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SQLite –≤–º–µ—Å—Ç–æ AsyncStorage.
**–†–µ—à–µ–Ω–∏–µ:** –ù–∞—á–Ω–∏—Ç–µ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ –∏–ª–∏ –º–∏–≥—Ä–∏—Ä—É–π—Ç–µ —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ.

---

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

–î–ª—è **1000 –∑–∞–ø–∏—Å–µ–π**:

| –û–ø–µ—Ä–∞—Ü–∏—è | AsyncStorage | SQLite |
|----------|--------------|--------|
| –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å | ~50 –º—Å | ~5 –º—Å ‚úÖ |
| –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ | ~200 –º—Å | ~30 –º—Å ‚úÖ |
| –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è | ~300 –º—Å | ~15 –º—Å ‚úÖ |
| –ü–æ–∏—Å–∫ –ø–æ ID | ~100 –º—Å | ~2 –º—Å ‚úÖ |

**SQLite –≤ 5-10 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ!** üöÄ

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
2. ‚úÖ –í—Å–µ —ç–∫—Ä–∞–Ω—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã
3. ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞–ø–∏—Å–∞–Ω–∞
4. ‚¨ú **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ!**
5. ‚¨ú –î–æ–±–∞–≤—å—Ç–µ —ç–∫—Ä–∞–Ω —Å–ø–∏—Å–∫–∞ –∑–∞–ø–∏—Å–µ–π
6. ‚¨ú –†–µ–∞–ª–∏–∑—É–π—Ç–µ –≥—Ä–∞—Ñ–∏–∫ —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –ë–î
7. ‚¨ú –î–æ–±–∞–≤—å—Ç–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π

---

## üí° –°–æ–≤–µ—Ç—ã

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `test-database.md` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏ SQL
- –ë–∞–∑–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

### –î–ª—è production:
- –†–µ–∞–ª–∏–∑—É–π—Ç–µ –±—ç–∫–∞–ø –¥–∞–Ω–Ω—ã—Ö
- –î–æ–±–∞–≤—å—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å —Å–µ—Ä–≤–µ—Ä–æ–º
- –°–¥–µ–ª–∞–π—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é —Å–æ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏–π

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é SQLite –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö!

**–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ:**
```bash
npx expo start
# –ù–∞–∂–º–∏—Ç–µ 'w' –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞
```

–î–æ–±–∞–≤—å—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, –∫–∞–∫ –±—ã—Å—Ç—Ä–æ –æ–Ω–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è! ‚ö°

---

**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 19 –Ω–æ—è–±—Ä—è 2024  
**–í–µ—Ä—Å–∏—è:** 2.0.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–∞—è (SQLite)


